## Introductions

This folder contains notebooks for analysis and relevant python libraries.

Three libraries exist uner this directory:
`csv_decoder.py` reads .csv file produced by Josh's showering program and performs clustering and fast detector simulation.
`save_and_load.py` saves and loads a fixed list of essential data needed for analysis into .npy files to speed up data i/o. The list of essential data is as follows:

```
	new_background_event_list, new_signal_event_list, (arrays, saved and loaded with save() and load() from .npy)
	new_background_mass_list, new_signal_mass_list, (arrays, saved and from .npy)
    new_background_weight, new_signal_weight, (floats, saved and loaded from .npy)
    new_background_image_list, new_signal_image_list, (arrays, saved and loaded from .npy)
    new_background_recluster_images, new_signal_recluster_images (arrays, saved and loaded from .npy)
```

It can also generate 
```
	new_background_event_list_clustered, new_signal_event_list_clustered, (list with c++ objects,)
    new_background_reclustered, new_signal_reclustered (list with c++ objects, need to be generated every time.)
```        
`substructure.py` contains some methods for substructure variables.

Use of methods are documented in each .py files.

To run all notebooks on squirrel, you can use this pre-configured conda environment in `environment.yaml` using:
```
conda env create -f environment.yaml
```

## I just did showering. How to start doing CNN?

After showering, you should have a number of .csv files generated by the pythia c++ executable. These contains the `pt`, `eta`, `phi`, `m`, `id` and `isCharged` of each particle. 

1. Please run `csv-to-npy.ipynb` ONLY ONCE to generate 40x40 event and jet images stored as .npy files (faster to read for large datasets)
2. Then run `produce-train-test-val.ipynb` ONLY ONCE to produce .hdf5 datasets for access by keras CNN (these can be accessed like numpy arrays without files calls, and can avoid keeping all datasets in memory)
3. Open`hbb-qcd-hyperparameter-tuning.ipynb` to do hyperparameter tuning and analyses.

## Notes about naming convention

Event image datasets are named x_train, y_train; x_test, y_test; and x_val, y_val. Relatively straightforward
*Jet Image Datasets* are named x_train_r, y_train_r; x_test_r, y_test_r; and x_val_r, y_val_r. These are left behind from Josh's original analysis code, due to jet images being called "reclustered images" in his earlier studies.
